{"remainingRequest":"C:\\Users\\Administrator\\yuanhang\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\yuanhang\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Administrator\\yuanhang\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\yuanhang\\src\\views\\article-manage\\article-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\yuanhang\\src\\views\\article-manage\\article-list.vue","mtime":1563714008424},{"path":"C:\\Users\\Administrator\\yuanhang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\yuanhang\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\yuanhang\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\yuanhang\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"C:\\\\Users\\\\Administrator\\\\yuanhang\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"C:\\\\Users\\\\Administrator\\\\yuanhang\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/asyncToGenerator\"));\n\nvar _articleManage = require(\"@/api/article-manage\");\n\nvar _Pagination = _interopRequireDefault(require(\"@/components/Pagination\"));\n\nvar _waves = _interopRequireDefault(require(\"@/directive/waves\"));\n\nvar _Tinymce = _interopRequireDefault(require(\"@/components/Tinymce\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// secondary package based on el-pagination\n// waves directive\nvar _default = {\n  name: 'ComplexTable',\n  components: {\n    Pagination: _Pagination.default,\n    Tinymce: _Tinymce.default\n  },\n  directives: {\n    waves: _waves.default\n  },\n  filters: {\n    statusFilter: function statusFilter(status) {\n      var statusMap = {\n        published: 'success',\n        draft: 'info',\n        deleted: 'danger'\n      };\n      return statusMap[status];\n    },\n    typeFilter: function typeFilter(type) {\n      return calendarTypeKeyValue[type];\n    }\n  },\n  data: function data() {\n    return {\n      imageUrl: '',\n      tableKey: 0,\n      list: null,\n      categorylist: null,\n      total: 0,\n      listLoading: true,\n      listQuery: {\n        page: 1,\n        limit: 10,\n        _kw: undefined,\n        _t: 'name'\n      },\n      importanceOptions: [1, 2, 3],\n      sortOptions: [{\n        label: '标题',\n        key: 'name'\n      }],\n      statusOptions: ['published', 'draft', 'deleted'],\n      showReviewer: false,\n      temp: {\n        is_show: 101,\n        is_top: 101,\n        category_id: '',\n        images: '',\n        content: ''\n      },\n      dialogFormVisible: false,\n      dialogStatus: '',\n      textMap: {\n        update: '编辑',\n        create: '新增'\n      },\n      dialogPvVisible: false,\n      pvData: [],\n      rules: {\n        title: [{\n          required: true,\n          message: '标题必填',\n          trigger: 'blur'\n        }],\n        category_id: [{\n          required: true,\n          message: '分类必填',\n          trigger: 'blur'\n        }]\n      },\n      downloadLoading: false\n    };\n  },\n  created: function created() {\n    this.getList();\n    this.categoryList();\n  },\n  methods: {\n    handleAvatarSuccess: function handleAvatarSuccess(res, file) {\n      this.imageUrl = URL.createObjectURL(file.raw);\n      this.temp.images = res.data;\n    },\n    beforeAvatarUpload: function beforeAvatarUpload(file) {\n      var isJPG = file.type === 'image/jpeg';\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n\n      return isJPG && isLt2M;\n    },\n    categoryList: function categoryList() {\n      var _this = this;\n\n      (0, _articleManage.getCategoryList)().then(function (response) {\n        _this.categorylist = response.data;\n      });\n    },\n    getList: function getList() {\n      var _this2 = this;\n\n      this.listLoading = true;\n      (0, _articleManage.articleList)(this.listQuery).then(function (response) {\n        _this2.list = response.data.data;\n        _this2.total = response.data.total; // Just to simulate the time of the request\n\n        setTimeout(function () {\n          _this2.listLoading = false;\n        }, 1.5 * 1000);\n      });\n    },\n    handleFilter: function handleFilter() {\n      this.listQuery.page = 1;\n      this.getList();\n    },\n    handleModifyStatus: function handleModifyStatus(_ref) {\n      var _this3 = this;\n\n      var $index = _ref.$index,\n          row = _ref.row;\n      this.$confirm('确定删除此文章吗?', '删除提示', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(\n      /*#__PURE__*/\n      (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return (0, _articleManage.deleteArticle)(row.id);\n\n              case 2:\n                _this3.list.splice($index, 1);\n\n                _this3.$message({\n                  type: 'success',\n                  message: '删除成功!'\n                });\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))).catch(function (err) {\n        console.error(err);\n      });\n    },\n    sortChange: function sortChange(data) {\n      var prop = data.prop,\n          order = data.order;\n\n      if (prop === 'id') {\n        this.sortByID(order);\n      }\n    },\n    sortByID: function sortByID(order) {\n      if (order === 'ascending') {\n        this.listQuery.sort = '+id';\n      } else {\n        this.listQuery.sort = '-id';\n      }\n\n      this.handleFilter();\n    },\n    resetTemp: function resetTemp() {\n      this.imageUrl = '';\n      this.temp = {\n        is_show: 101,\n        is_top: 101,\n        content: ''\n      };\n    },\n    handleCreate: function handleCreate() {\n      var _this4 = this;\n\n      this.resetTemp();\n      this.dialogStatus = 'create';\n      this.dialogFormVisible = true;\n      this.$nextTick(function () {\n        _this4.$refs['dataForm'].clearValidate();\n      });\n    },\n    createData: function createData() {\n      var _this5 = this;\n\n      this.$refs['dataForm'].validate(function (valid) {\n        if (valid) {\n          (0, _articleManage.createArticle)(_this5.temp).then(function (response) {\n            _this5.temp.id = response.data.id;\n            var str = response.data.created_at.date;\n            var s1 = str.substring(0, str.length - 7);\n            _this5.temp.created_at = s1;\n            _this5.temp.category_name = response.data.cat_name;\n\n            _this5.list.unshift(_this5.temp);\n\n            _this5.dialogFormVisible = false;\n\n            _this5.$notify({\n              title: '文章',\n              message: '增加文章成功',\n              type: 'success',\n              duration: 2000\n            });\n          });\n        }\n      });\n    },\n    handleUpdate: function handleUpdate(scope) {\n      var _this6 = this;\n\n      this.temp = Object.assign({}, scope.row); // copy obj\n\n      console.log(JSON.stringify(this.temp));\n      this.imageUrl = this.temp.thumbnail; // this.temp.timestamp = new Date(this.temp.timestamp)\n\n      this.dialogStatus = 'update';\n      this.dialogFormVisible = true;\n      this.$nextTick(function () {\n        _this6.$refs['dataForm'].clearValidate();\n      });\n    },\n    updateData: function updateData() {\n      var _this7 = this;\n\n      this.$refs['dataForm'].validate(function (valid) {\n        if (valid) {\n          var tempData = Object.assign({}, _this7.temp);\n\n          _this7.$delete(tempData, 'created_at');\n\n          (0, _articleManage.updatePermission)(tempData).then(function () {\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n              for (var _iterator = _this7.list[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var v = _step.value;\n\n                if (v.id === _this7.temp.id) {\n                  var index = _this7.list.indexOf(v);\n\n                  _this7.list.splice(index, 1, _this7.temp);\n\n                  break;\n                }\n              }\n            } catch (err) {\n              _didIteratorError = true;\n              _iteratorError = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n              } finally {\n                if (_didIteratorError) {\n                  throw _iteratorError;\n                }\n              }\n            }\n\n            _this7.dialogFormVisible = false;\n\n            _this7.$notify({\n              title: '权限',\n              message: '编辑权限成功',\n              type: 'success',\n              duration: 2000\n            });\n          });\n        }\n      });\n    },\n    handleDelete: function handleDelete(row) {\n      this.$notify({\n        title: 'Success',\n        message: 'Delete Successfully',\n        type: 'success',\n        duration: 2000\n      });\n      var index = this.list.indexOf(row);\n      this.list.splice(index, 1);\n    }\n  }\n};\nexports.default = _default;",null]}